name: Elixir CI - FreeBSD

on: push

jobs:
  freebsd:
    runs-on: ubuntu-latest
    name: FreeBSD / Elixir
    steps:
    - uses: actions/checkout@v4
    - name: Test in FreeBSD
      id: test
      uses: vmactions/freebsd-vm@v1
      with:
        usesh: true
        prepare: |
          pkg install -y erlang
          pkg install -y elixir-devel

        run: |
          echo "getting deps"
          mix deps.get
          echo "compiling"
          mix compile    
          echo "getting zig"    
          mix zig.get
          echo "running tests"
          mix test --exclude no_ci